@* Modal Component - Reusable modal dialog following modern UX patterns *@

<div class="modal-overlay" @onclick="OnOverlayClick">
    <div class="modal-dialog modal-@Size" @onclick:stopPropagation>
        <div class="modal-header">
            <h2 class="modal-title">@Title</h2>
            <button type="button" class="modal-close" @onclick="Close" aria-label="Fechar">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15 5L5 15M5 5L15 15" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </button>
        </div>
        <div class="modal-body">
            @ChildContent
        </div>
        @if (Footer != null)
        {
            <div class="modal-footer">
                @Footer
            </div>
        }
    </div>
</div>

@code {
    /// <summary>
    /// Modal title displayed in the header
    /// </summary>
    [Parameter]
    public string Title { get; set; } = "";

    /// <summary>
    /// Modal size: sm (400px), md (540px), lg (720px), xl (960px)
    /// </summary>
    [Parameter]
    public string Size { get; set; } = "md";

    /// <summary>
    /// Modal body content
    /// </summary>
    [Parameter]
    public RenderFragment? ChildContent { get; set; }

    /// <summary>
    /// Optional footer content (for custom action buttons)
    /// </summary>
    [Parameter]
    public RenderFragment? Footer { get; set; }

    /// <summary>
    /// Event callback fired when modal is closed
    /// </summary>
    [Parameter]
    public EventCallback OnClose { get; set; }

    /// <summary>
    /// Whether clicking the overlay should close the modal (default: true)
    /// </summary>
    [Parameter]
    public bool CloseOnOverlayClick { get; set; } = true;

    /// <summary>
    /// Close the modal
    /// </summary>
    private async Task Close()
    {
        await OnClose.InvokeAsync();
    }

    /// <summary>
    /// Handle overlay click
    /// </summary>
    private async Task OnOverlayClick()
    {
        if (CloseOnOverlayClick)
        {
            await Close();
        }
    }

    protected override void OnInitialized()
    {
        // Add keyboard listener for ESC key
        // Note: In a production app, you'd want to add JavaScript interop for ESC key handling
    }
}
